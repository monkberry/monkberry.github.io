<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Monkberry by monkberry</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Monkberry</h1>
      <h2 class="project-tagline">Monkberry is a JavaScript library for building web user interfaces</h2>
    </section>

    <section class="main-content">
      <h1>
<a id="monkberry" class="anchor" href="#monkberry" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry</h1>

<p><a href="https://travis-ci.org/monkberry/monkberry"><img src="https://travis-ci.org/monkberry/monkberry.svg?branch=master" alt="Build Status"></a></p>

<p>Monkberry is <strong>blazingly fast</strong>, <strong>small <code>1kb</code></strong> and <strong>simple</strong> JavaScript library for building <strong>web user interfaces</strong>.</p>

<h2>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h2>

<p>Monkberry comes with powerfull templating engine, which is compiled to JavaScript.</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">ol</span>&gt;
  {% <span class="pl-k">for</span> <span class="pl-smi">todos</span> %}
    &lt;<span class="pl-ent">li</span>&gt;
      {% <span class="pl-k">if</span> <span class="pl-smi">complete</span> %}
        &lt;<span class="pl-ent">del</span>&gt;{{ <span class="pl-smi">text</span> }}&lt;/<span class="pl-ent">del</span>&gt;
      {% <span class="pl-k">else</span> %}
        &lt;<span class="pl-ent">em</span>&gt;{{ <span class="pl-smi">text</span> }}&lt;/<span class="pl-ent">em</span>&gt;
      {% <span class="pl-k">endif</span> %}
    &lt;/<span class="pl-ent">li</span>&gt;
  {% <span class="pl-k">endfor</span> %}
&lt;/<span class="pl-ent">ol</span>&gt;</pre></div>

<p>and then</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">import</span> <span class="pl-smi">Monkberry</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>monkberry<span class="pl-pds">'</span></span>;
<span class="pl-k">import</span> <span class="pl-smi">Template</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>template.monk<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">view</span> <span class="pl-k">=</span> <span class="pl-smi">Monkberry</span>.<span class="pl-en">render</span>(Template, <span class="pl-c1">document</span>.<span class="pl-c1">body</span>);

<span class="pl-smi">view</span>.<span class="pl-en">update</span>({todos<span class="pl-k">:</span> [<span class="pl-k">...</span>]});</pre></div>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Small <strong><code>1kb</code></strong> minified &amp; gzipped</li>
<li>Simple, small learning curve</li>
<li>Fully tested</li>
<li>Precompiled templates</li>
<li>SourceMaps</li>
<li>Custom tags</li>
<li>Blazingly fast (only necessary dom updates)</li>
</ul>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Documentation</h2>

<p>Documentation available on <a href="http://monkberry.js.org">monkberry.js.org</a> site.</p>

<h2>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of Contents</h2>

<ul>
<li><a href="#example">Example</a></li>
<li>
<a href="#documentation">Documentation</a>

<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#expressions">Expressions</a></li>
<li><a href="#if-else">If, Else</a></li>
<li><a href="#for">For</a></li>
<li><a href="#default-values">Default values</a></li>
<li><a href="#filters">Filters</a></li>
<li><a href="#custom-tags">Custom tags</a></li>
<li><a href="#spread-attributes">Spread attributes</a></li>
<li><a href="#importing">Importing</a></li>
<li><a href="#event-handling">Event Handling</a></li>
<li><a href="#globals">Globals</a></li>
<li><a href="#prerender">Prerender</a></li>
<li><a href="#transforms">Transforms</a></li>
<li><a href="#unsafe">Unsafe</a></li>
<li><a href="#comments">Comments</a></li>
<li><a href="#blocks">Blocks</a></li>
</ul>
</li>
<li>
<a href="#api-reference">API Reference</a>

<ul>
<li>
<a href="#monkberry">Monkberry</a>

<ul>
<li><a href="#monkberryrendername-values-nocache">monkberry.render(template, node[, options])</a></li>
<li>
<a href="#monkberryprerendername-times">monkberry.prerender(template, times)</a> </li>
<li><a href="#viewappendtotonode">Monkberry.prototype.appendTo(toNode)</a></li>
<li><a href="#viewinsertbeforetonode">Monkberry.prototype.insertBefore(toNode)</a></li>
<li><a href="#viewcreatedocument">Monkberry.prototype.createDocument()</a></li>
<li><a href="#viewupdatedata">Monkberry.prototype.update(data)</a></li>
<li><a href="#viewremoveforce">Monkberry.prototype.remove()</a></li>
<li><a href="#viewqueryselectorquery">Monkberry.prototype.querySelector(query)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tests">Tests</a></li>
<li><a href="#plugins">Plugins</a></li>
<li><a href="#benchmarks">Benchmarks</a></li>
</ul>

<h2>
<a id="example-1" class="anchor" href="#example-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h2>

<p>Monkberry will compile this template:</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">div</span>&gt;
  &lt;<span class="pl-ent">h1</span>&gt;{{ title }}&lt;/<span class="pl-ent">h1</span>&gt;
  &lt;<span class="pl-ent">p</span>&gt;
    {{ text }}
  &lt;/<span class="pl-ent">p</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

<p>To JavaScript code like this:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> div <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>div<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> h1 <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>h1<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> p <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>p<span class="pl-pds">'</span></span>);

<span class="pl-smi">div</span>.<span class="pl-c1">appendChild</span>(h1);
<span class="pl-smi">div</span>.<span class="pl-c1">appendChild</span>(p);

   <span class="pl-k">...</span>

<span class="pl-smi">view</span>.<span class="pl-en">update</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
  <span class="pl-smi">h1</span>.<span class="pl-smi">textContent</span> <span class="pl-k">=</span> <span class="pl-smi">data</span>.<span class="pl-c1">title</span>;
  <span class="pl-smi">p</span>.<span class="pl-smi">textContent</span> <span class="pl-k">=</span> <span class="pl-smi">data</span>.<span class="pl-c1">text</span>;
};</pre></div>

<p>Which can be used like that: </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> view <span class="pl-k">=</span> <span class="pl-smi">Monkberry</span>.<span class="pl-en">render</span>(template, <span class="pl-c1">document</span>.<span class="pl-c1">body</span>);

<span class="pl-smi">view</span>.<span class="pl-en">update</span>({
  title<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Monkberry<span class="pl-pds">'</span></span>,
  text<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>JavaScript DOM template engine<span class="pl-pds">'</span></span>
});</pre></div>

<h2>
<a id="documentation-1" class="anchor" href="#documentation-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Documentation</h2>

<h3>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h3>

<p>Monkberry has support for both browserify via <a href="https://github.com/monkberry/monkberrify">monkberrify</a> and for webpack via <a href="https://github.com/monkberry/monkberry-loader">monkberry-loader</a>. </p>

<p>Monkberry can be used like CLI tool. Install Monkberry globally:</p>

<pre><code>npm install monkberry -g
</code></pre>

<p>To compile all templates into single JavaScript file with source map run next command:</p>

<pre><code>monkberry --source-map --output template.js templates/*.html
</code></pre>

<p>Require generated <code>template.js</code> and <code>monkberry.js</code> files and render that view.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Monkberry <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>monkberry<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> Template <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>./template.js<span class="pl-pds">'</span></span>);

<span class="pl-k">var</span> view <span class="pl-k">=</span> <span class="pl-smi">Monkberry</span>.<span class="pl-en">render</span>(Template, <span class="pl-c1">document</span>.<span class="pl-c1">body</span>);</pre></div>

<p>Now, to update data of view on page:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({<span class="pl-k">...</span>});
<span class="pl-c">// or update only what's needed</span>
<span class="pl-smi">view</span>.<span class="pl-en">update</span>({key<span class="pl-k">:</span> value});</pre></div>

<h3>
<a id="expressions" class="anchor" href="#expressions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Expressions</h3>

<p>Monkberry perceives everything inside <code>{{</code> and <code>}}</code> mustache as JavaScript expression.</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>greetings {{ visible ? '' : 'hidden' }}<span class="pl-pds">"</span></span>&gt;
  Hello, {{ user.name + "!" }}
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

<h3>
<a id="if-else" class="anchor" href="#if-else" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>If, Else</h3>

<p>Can be any valid JavaScrpt expressions.</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">if</span> <span class="pl-smi">count</span> <span class="pl-k">&lt;</span> <span class="pl-c1">0</span> || <span class="pl-smi">count</span> <span class="pl-k">&gt;</span> <span class="pl-c1">10</span> %}
  ...
{% <span class="pl-k">else</span> %}
  ...
{% <span class="pl-k">endif</span> %}</pre></div>

<p>Any number on variables in <code>if</code>:</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">if</span> array.<span class="pl-smi">indexOf</span>(<span class="pl-smi">search</span>) <span class="pl-k">!=</span> -1 %}
  ...
{% <span class="pl-k">endif</span> %}</pre></div>

<blockquote>
<p>Note what Monkberry update only one of <code>if</code>/<code>else</code> block.</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">if</span> <span class="pl-smi">check</span> %}
  Then {{ <span class="pl-smi">value</span> }}!
{% <span class="pl-k">else</span> %}
  Else {{ <span class="pl-smi">value</span> }}!
{% <span class="pl-k">endif</span> %}</pre></div>

<p>Render that template:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> view <span class="pl-k">=</span> <span class="pl-smi">Monkberry</span>.<span class="pl-en">render</span>(Example, <span class="pl-c1">document</span>.<span class="pl-c1">body</span>);
<span class="pl-smi">view</span>.<span class="pl-en">update</span>({
  check<span class="pl-k">:</span> <span class="pl-c1">true</span>,
  value<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span>
});</pre></div>

<p>View will be <code>Then one!</code>. When if update view:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({
  check<span class="pl-k">:</span> <span class="pl-c1">false</span>,
  value<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>two<span class="pl-pds">'</span></span>
});</pre></div>

<p>View will be <code>Else two!</code>. But if update only <code>check</code>, variable of then part will be same as before.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({check<span class="pl-k">:</span> <span class="pl-c1">true</span>});</pre></div>

<p>View will be <code>Then one!</code>. </p>

<p>This is happens because Monkberry does not stores variables passed to <code>update</code> function, it stores only DOM nodes.
Monkberry will update only one part of <code>if</code>/<code>else</code>.</p>
</blockquote>

<h3>
<a id="for" class="anchor" href="#for" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For</h3>

<p>Monkberry can loop other arrays and objects as well. </p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">for</span> <span class="pl-smi">array</span> %}
  {{ <span class="pl-smi">name</span> }}
{% <span class="pl-k">endfor</span> %}</pre></div>

<p>In this form, body of <code>for</code> has access only for variables iterating on.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({
  array<span class="pl-k">:</span> [
    {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Anton<span class="pl-pds">'</span></span>},
    <span class="pl-k">...</span>
  ]
});</pre></div>

<p>To access outer scope specify iterator name.</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">for</span> <span class="pl-smi">user</span> <span class="pl-smi">of</span> <span class="pl-smi">array</span> %}
  {{ <span class="pl-smi">user</span>.<span class="pl-smi">name</span> }}
{% <span class="pl-k">endfor</span> %}</pre></div>

<p>Also key can be specified.</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">for</span> <span class="pl-smi">key</span>, <span class="pl-smi">user</span> <span class="pl-smi">of</span> <span class="pl-smi">array</span> %}
  {{ <span class="pl-smi">key</span> }}: {{ <span class="pl-smi">user</span>.<span class="pl-smi">name</span> }}
{% <span class="pl-k">endfor</span> %}</pre></div>

<h3>
<a id="default-values" class="anchor" href="#default-values" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Default values</h3>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>foo {{ <span class="pl-smi">modify</span> || <span class="pl-s"><span class="pl-pds">'</span>baz<span class="pl-pds">'</span></span> }}<span class="pl-pds">"</span></span>&gt;
    {{ <span class="pl-smi">content</span> || <span class="pl-s"><span class="pl-pds">"</span>No content<span class="pl-pds">"</span></span> }}
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

<p>View rendered without data will be filled with default data:</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>foo baz<span class="pl-pds">"</span></span>&gt;
    No content
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

<p>Note if you will use some variable in right side of <em>OR</em> operator, what can't be used as default data.</p>

<div class="highlight highlight-text-html-twig"><pre>{{ <span class="pl-smi">content</span> || <span class="pl-s"><span class="pl-pds">"</span>No content<span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-smi">foo</span> }}</pre></div>

<h3>
<a id="filters" class="anchor" href="#filters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Filters</h3>

<p>Any expression support filter statement.</p>

<div class="highlight highlight-text-html-twig"><pre>Hello, {{ <span class="pl-smi">user</span>.<span class="pl-smi">name</span> | <span class="pl-smi">upper</span> }}</pre></div>

<p>To define that filter:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Template</span>.<span class="pl-smi">filters</span>.<span class="pl-en">upper</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">text</span>) {
  <span class="pl-k">return</span> <span class="pl-smi">text</span>.<span class="pl-c1">toUpperCase</span>();
};</pre></div>

<p>Also Monkberry understand parameters for filters:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">template</span>.<span class="pl-smi">filters</span>.<span class="pl-en">replace</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">text</span>, <span class="pl-k">from</span>, <span class="pl-smi">to</span>) {
  <span class="pl-k">return</span> <span class="pl-smi">text</span>.<span class="pl-c1">replace</span>(<span class="pl-k">from</span>, to);
};</pre></div>

<div class="highlight highlight-text-html-twig"><pre>{{ <span class="pl-smi">text</span> | replace(/.../, <span class="pl-s"><span class="pl-pds">'</span>$1<span class="pl-pds">'</span></span>) }}</pre></div>

<p>And allow to combine filters:</p>

<div class="highlight highlight-text-html-twig"><pre>{{ <span class="pl-smi">text</span> | <span class="pl-smi">lower</span> | replace(/.../, <span class="pl-s"><span class="pl-pds">'</span>$1<span class="pl-pds">'</span></span>) | <span class="pl-smi">upper</span> }}</pre></div>

<p>That expression will be compiled to next JavaScript:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-en">upper</span>(<span class="pl-en">replace</span>(<span class="pl-en">lower</span>(text),<span class="pl-sr"> <span class="pl-pds">/</span><span class="pl-c1">...</span><span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span>$1<span class="pl-pds">'</span></span>));</pre></div>

<p>Filters can be used in expressions, <code>if</code> and <code>for</code> statements.</p>

<h3>
<a id="custom-tags" class="anchor" href="#custom-tags" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Custom tags</h3>

<p>Custom tag template <code>greet.monk</code>:</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">div</span>&gt;
  {{ <span class="pl-smi">value</span> }}, {{ <span class="pl-smi">name</span> }}!
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

<p>To render that custom tag in another template:</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">import</span> <span class="pl-smi">greet</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./greet.monk<span class="pl-pds">'</span></span> %}
&lt;<span class="pl-ent">greet</span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>&gt;
&lt;<span class="pl-ent">greet</span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>{{ <span class="pl-smi">user</span>.<span class="pl-smi">name</span> }}<span class="pl-pds">"</span></span>&gt;</pre></div>

<h3>
<a id="spread-attributes" class="anchor" href="#spread-attributes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Spread attributes</h3>

<p>Spread attributes allow easily convert object into node attributes.<br>
The properties of the object that you pass in are copied onto the node's attributes.</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">input</span> {{...attr}}/&gt;</pre></div>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({attr<span class="pl-k">:</span> {
  id<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>, 
  value<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>baz<span class="pl-pds">'</span></span>
}});</pre></div>

<p>You can combine it with other attributes.</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">input</span> {{...attr}} <span class="pl-e">value</span>={{ <span class="pl-smi">value</span> }}/&gt;</pre></div>

<p>Note what later updates of attributes override previous ones.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">update</span>({value<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>baz<span class="pl-pds">'</span></span>});
<span class="pl-c">// ...</span>
<span class="pl-smi">view</span>.<span class="pl-en">update</span>({attr<span class="pl-k">:</span> {value<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>new baz<span class="pl-pds">'</span></span>}}); <span class="pl-c">// Will override previous value.</span></pre></div>

<p>Spread operator also works well with custom attributes. In fact, this is best way to pass data into custom tag. </p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">my</span><span class="pl-e">-tag</span> {{...attr}}/&gt;</pre></div>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">my</span><span class="pl-e">-tag</span>&gt;
    &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>={{ <span class="pl-smi">type</span> }} <span class="pl-e">value</span>={{ <span class="pl-smi">value</span> }}&gt;
&lt;/<span class="pl-ent">my</span><span class="pl-e">-tag</span>&gt;</pre></div>

<h3>
<a id="importing" class="anchor" href="#importing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Importing</h3>

<p>It is possible to require template within another template. </p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">import</span> <span class="pl-smi">Component</span> <span class="pl-s"><span class="pl-pds">'</span>./Component.monk<span class="pl-pds">'</span></span> %}

    &lt;<span class="pl-ent">Component</span>/&gt;
</pre></div>

<p>Also it's possible to include any JS file or module:</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">import</span> <span class="pl-smi">upperCase</span> <span class="pl-s"><span class="pl-pds">'</span>upper-case<span class="pl-pds">'</span></span> %}
// ...
{{ upperCase(<span class="pl-smi">name</span>) }}</pre></div>

<h3>
<a id="event-handling" class="anchor" href="#event-handling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Event Handling</h3>

<p>There are a few ways to deal with event handling in Monkberry.
Add event listener to node directly: </p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">querySelector</span>(<span class="pl-s"><span class="pl-pds">'</span>.button<span class="pl-pds">'</span></span>).<span class="pl-en">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>click<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">event</span>) {
    <span class="pl-k">...</span>
});</pre></div>

<p>But this is difficult when dealing with conditions and loops.</p>

<p>Better approach is to use <a href="https://github.com/monkberry/events">event delegating</a>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">view</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>click<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>.button<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">event</span>) {
    <span class="pl-k">...</span>
});</pre></div>

<h3>
<a id="globals" class="anchor" href="#globals" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Globals</h3>

<p>Monkberry also support global variables. This is very usefull if using <code>window</code> variable inside of templates. 
Or if using translation function like this: <code>{{ __('greeting') + userName }}</code>. </p>

<p>To do it, you need to specify globals as array of variables names for compiler to pass. Read monkberry loaders docs for more info.   </p>

<h3>
<a id="prerender" class="anchor" href="#prerender" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerender</h3>

<p>To speedup render Monkberry can prerender DOM nodes to use them in future.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Monkberry</span>.<span class="pl-en">prerender</span>(Template, <span class="pl-c1">10</span>); <span class="pl-c">// Preprender template 10 times.</span></pre></div>

<p>Then next <code>render</code> call will use one of these prerendered views:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">Monkberry</span>.<span class="pl-en">render</span>(Template, node); <span class="pl-c">// Will use already created DOM nodes.</span></pre></div>

<p>This is very usefull to do then browser waiting some xhr request.</p>

<h3>
<a id="transforms" class="anchor" href="#transforms" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Transforms</h3>

<p>Transformers allow to modify <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> before compilation of templates. 
List of AST nodes can be founded here: <a href="https://github.com/monkberry/parser/blob/master/src/ast.js">ast.js</a>
Example of transform which trim whitespaces: <a href="https://github.com/monkberry/monkberry/blob/master/src/optimize/whitespace.js">whitespace.js</a></p>

<p>Add transforms to Monkbeery before compilation:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">import</span> { <span class="pl-smi">Compiler</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>monkberry<span class="pl-pds">'</span></span>;
<span class="pl-k">import</span> { <span class="pl-smi">myTransform</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./myTransform<span class="pl-pds">'</span></span>;

<span class="pl-k">var</span> compiler <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Compiler</span>();
<span class="pl-smi">compiler</span>.<span class="pl-smi">transforms</span>.<span class="pl-smi">custom</span> <span class="pl-k">=</span> myTransform;</pre></div>

<h3>
<a id="unsafe" class="anchor" href="#unsafe" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Unsafe</h3>

<p>Monkberry escape all inserted variables by default. But if some times you want to insert 
some HTML template via variable you can you <em>unsafe</em> statement which is using <code>innerHTML</code>. 
Improper use of the <em>unsafe</em> statement can open you up to a <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting (XSS)</a> attack. </p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-smi">unsafe</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;a href="XSS"&gt;...&lt;/a&gt;<span class="pl-pds">'</span></span> %}
{% <span class="pl-smi">unsafe</span> <span class="pl-smi">html</span> %}</pre></div>

<h3>
<a id="comments" class="anchor" href="#comments" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Comments</h3>

<p>You can use standard html comments.</p>

<div class="highlight highlight-text-html-twig"><pre><span class="pl-c">&lt;!-- Comment does here --&gt;</span></pre></div>

<p>Comments will be cut out from template. </p>

<h2>
<a id="api-reference" class="anchor" href="#api-reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Reference</h2>

<p>Monkberry API strictly follows <a href="http://semver.org">semantic versioning</a>.  </p>

<h3>
<a id="monkberry-1" class="anchor" href="#monkberry-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry</h3>

<h4>
<a id="monkberryrendertemplate-node-options" class="anchor" href="#monkberryrendertemplate-node-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.render(template, node, options)</h4>

<p>Render template, and returns new <code>Monkberry</code> instance.</p>

<h4>
<a id="monkberryprerendertemplate-times" class="anchor" href="#monkberryprerendertemplate-times" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prerender(template, times)</h4>

<p>Generates views for future calls of render method.</p>

<h4>
<a id="monkberryprototypeappendtotonode" class="anchor" href="#monkberryprototypeappendtotonode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prototype.appendTo(toNode)</h4>

<p>Append rendered view nodes to specified node.</p>

<ul>
<li>
<code>toNode</code>: <code>Element</code> - DOM node.</li>
</ul>

<h4>
<a id="monkberryprototypeinsertbeforetonode" class="anchor" href="#monkberryprototypeinsertbeforetonode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prototype.insertBefore(toNode)</h4>

<p>Insert rendered view nodes before specified node.</p>

<ul>
<li>
<code>toNode</code>: <code>Element</code> - DOM node.</li>
</ul>

<h4>
<a id="monkberryprototypecreatedocument" class="anchor" href="#monkberryprototypecreatedocument" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prototype.createDocument()</h4>

<p>Return view's nodes. Note what if your template contains more then one root element, <code>createDocument</code> function will 
return <code>DocumentFragment</code> what contains all these nodes. If you have only one root node, it will be returned as is.</p>

<h4>
<a id="monkberryprototypeupdatedata" class="anchor" href="#monkberryprototypeupdatedata" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prototype.update(data)</h4>

<p>Update rendered template with new data. You can specify only part of data to update or update entire data.</p>

<ul>
<li>
<code>data</code>: <code>Object|Array</code> - values to update in template.</li>
</ul>

<p>Example:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> data <span class="pl-k">=</span> {
    title<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Title #1<span class="pl-pds">'</span></span>,
    content<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>
};

<span class="pl-smi">view</span>.<span class="pl-en">update</span>({title<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Title #2<span class="pl-pds">'</span></span>});</pre></div>

<h4>
<a id="monkberryprototyperemove" class="anchor" href="#monkberryprototyperemove" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monkberry.prototype.remove([)</h4>

<p>Remove view's nodes from document, and puts it to pool for future reuse.</p>

<h4>
<a id="viewqueryselectorquery" class="anchor" href="#viewqueryselectorquery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>view.querySelector(query)</h4>

<p>Select node by query.</p>

<ul>
<li>
<code>query</code>: <code>string</code> - query to select node.</li>
</ul>

<blockquote>
<p>Note what this function uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/matches">Element.matches()</a> for checking root nodes. Include polyfill for matches if you use it.</p>
</blockquote>

<p>If you template contains more then one nodes on first level, <code>querySelector</code> will look other all subtrees. Array of all top level nodes can be accessed by <code>view.nodes[]</code> array. </p>

<blockquote>
<p>Note what querySelector can not work with template which have if/for/custom node on first level.</p>

<div class="highlight highlight-text-html-twig"><pre>{% <span class="pl-k">if</span> <span class="pl-smi">cond</span> %}
    ...
{% <span class="pl-k">endif</span> %}</pre></div>

<p>You will got exception like this: <code>Can not use querySelector with non-element nodes on first level.</code></p>

<p>Solution is to wrap such statement into another node:</p>

<div class="highlight highlight-text-html-twig"><pre>&lt;<span class="pl-ent">div</span>&gt;
    {% <span class="pl-k">if</span> <span class="pl-smi">cond</span> %}
        ...
    {% <span class="pl-k">endif</span> %}
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>
</blockquote>

<h2>
<a id="tests" class="anchor" href="#tests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tests</h2>

<p>Monkberry uses <a href="http://jasmine.github.io">Jasmine</a> and <a href="https://github.com/airportyh/testem">testem</a>. To run test locally run:</p>

<pre><code>testem ci
</code></pre>

<h2>
<a id="plugins" class="anchor" href="#plugins" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugins</h2>

<ul>
<li><a href="https://atom.io/packages/language-monkberry">Atom Package</a></li>
<li><a href="https://github.com/monkberry/language-monkberry">Sublime Text Package</a></li>
</ul>

<h2>
<a id="benchmarks" class="anchor" href="#benchmarks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Benchmarks</h2>

<p>Benchmarks covers a few use cases, and compare Monkberry with <a href="https://facebook.github.io/react/">React</a> and innerHTML.
Also it's contains real site code for tests.</p>

<ul>
<li><a href="http://monkberry.github.io/benchmark/">monkberry.js.org/benchmark</a></li>
</ul>

      <footer class="site-footer">

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-72802692-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
